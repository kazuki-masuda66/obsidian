# 毎日のSpaceのデータ更新作業

- 3つのファイルをバックアップ
- 

![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image.png)

![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%201.png)

- OPUSからデータを取ってくる
    - Inquiry by Customized Condition
        - OPUS > Sales management＞CNTR BIZ
        - 
        
        ![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%202.png)
        
        ![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%203.png)
        
- 6週間分を取るので、To側に＋5した値を入れる
- TradeをLWT,　DirectionをEにする
- カラムの順番を並び替えてテンプレート登録する
- 

![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%204.png)

- ダウンロードしてEveryday OPUS updateフォルダーに格納
    - ファイル名を日付に変更して保存
- 1st POLがTarget。カントリーコードを2桁で分割
- 

![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%205.png)

- 隣にGW列を追加して、計算式をいれる
- Column AEに列追加する、名前をGW
- GW（Gross weight）を計算する
    - （Cargo weight ＋ Tare weight）/1000
- Pivotする、このシートをTrunkという名前にする
- 

![image.png](%E6%AF%8E%E6%97%A5%E3%81%AESpace%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B4%E6%96%B0%E4%BD%9C%E6%A5%AD/image%206.png)

- Trunkシートをコピーして、名前をPIVOTとする
    - PIVOTからTrunk POLを除く
    - ピポットテーブルを丸ごとコピーしてカラムJに貼り付ける
    - コピー先のほうからT POLを除く

- AX3フォルダにあるB1_ONEMIS  Space Controller Offline File (MAIN) - newを開く
    - シートの日付を今日に変える
    - 日付の横のシートのデータをヘッダ以外すべて削除
    - Sheet１は残す
    - G:\Shared drives\Latin West Coast\Space Control\Looker\1. Daily space update
    - このフォルダから最新データを持ってくる
        - SPC(ALC)
            - カラムIで列をInsert
            - VlookupでSheet１からデータを持ってくる

- バックアップを自分のLocal driveに保存する
    - AX1-AX4のすべてのファイルを
    - AX3は2つのファイル
-